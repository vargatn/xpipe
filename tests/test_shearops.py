import numpy as np
import xpipe.xhandle.shearops as shearops

def test_redges():
    cens, edges, areas = shearops.redges(0.1, 30, 15)

    true_cens = np.array([ 0.1245813 ,  0.18221925,  0.26652361,  0.38983165,  0.57018858,
                  0.83398825,  1.21983573,  1.78419684,  2.60966153,  3.81703024,
                  5.58299215,  8.1659823 , 11.94400155, 17.46993415, 25.55245811])
    true_edges = np.array([ 0.1       ,  0.14626534,  0.21393549,  0.31291346,  0.45768393,
                            0.66943295,  0.97914836,  1.43215465,  2.09474584,  3.06388706,
                            4.48140475,  6.55474177,  9.58731516, 14.02291885, 20.51066955,
                            30.        ])
    true_areas = np.array([3.57938895e-02, 7.65758325e-02, 1.63822882e-01, 3.50475283e-01,
                           7.49791010e-01, 1.60406906e+00, 3.43167299e+00, 7.34156639e+00,
                           1.57062160e+01, 3.36011699e+01, 7.18848271e+01, 1.53787156e+02,
                           3.29005305e+02, 7.03859108e+02, 1.50580442e+03])

    assert (cens == true_cens).all
    assert (edges == true_edges).all
    assert (areas == true_areas).all